function sendMeetingInvite(meeting) {
  const emailHtml = getMeetingHtmlTemplate()
    .replace('{{MEETING_TITLE}}', meeting.title)
    .replace('{{MEETING_ROOM}}', meeting.room)
    .replace('{{MEETING_DATE}}', meeting.date)
    .replace('{{START_TIME}}', meeting.start)
    .replace('{{END_TIME}}', meeting.end)
    .replace('{{ORGANIZER}}', meeting.organizer)
    .replace('{{NOTES}}', meeting.notes)
    .replace('{{BOOKING_ID}}', meeting.id);

  GmailApp.sendEmail(meeting.recipients.join(','), `Meeting Invitation: ${meeting.title}`, 'Please enable HTML to view this invitation.', {
    htmlBody: emailHtml
  });
}

// --- HTML Template Function ---
function getMeetingHtmlTemplate() {
  return `
<!DOCTYPE html> 
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="icon" href="//www.basilurtea.com/cdn/shop/files/Basilur.png" type="image/png">
<link rel="apple-touch-icon" href="//www.basilurtea.com/cdn/shop/files/Basilur.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meeting Invitation</title>
</head>
<body style="margin:0;padding:0;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);font-family:'Poppins',sans-serif;color:#f5f5f5;">

  <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="padding:40px 0;">
    <tr>
      <td align="center">
        <table width="600" cellpadding="0" cellspacing="0" border="0" style="background:rgba(15,32,39,0.95);border-radius:12px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,0.4);">

          <!-- Header -->
          <tr>
            <td align="center" style="padding:20px;background:#2c5364;border-bottom:2px solid #00bcd4;">
              <img src="//www.basilurtea.com/cdn/shop/files/Basilur.png" alt="Company Logo" width="60" style="display:block;margin-bottom:10px;">
              <h1 style="color:#00bcd4;font-size:20px;margin:0;">Meeting Invitation</h1>
            </td>
          </tr>

          <!-- Body -->
          <tr>
            <td style="padding:30px 40px;">
              <p style="font-size:16px;margin-bottom:10px;">You have been invited to a meeting:</p>

              <div style="background:rgba(32,58,67,0.9);padding:20px;border-radius:10px;border:1px solid rgba(0,188,212,0.35);margin-bottom:25px;line-height:1.6;">
                <p style="margin:0 0 8px;"><strong style="color:#00bcd4;">üìÖ Meeting:</strong> {{MEETING_TITLE}}</p>
                <p style="margin:0 0 8px;"><strong style="color:#00bcd4;">üè¢ Room:</strong> {{MEETING_ROOM}}</p>
                <p style="margin:0 0 8px;"><strong style="color:#00bcd4;">üìÜ Date:</strong> {{MEETING_DATE}}</p>
                <p style="margin:0 0 8px;"><strong style="color:#00bcd4;">üïê Start Time:</strong> {{START_TIME}}</p>
                <p style="margin:0 0 8px;"><strong style="color:#00bcd4;">üïë End Time:</strong> {{END_TIME}}</p>
                <p style="margin:0 0 8px;"><strong style="color:#00bcd4;">üë§ Organized by:</strong> {{ORGANIZER}}</p>
                <p style="margin:15px 0 8px;"><strong style="color:#00bcd4;">üìù Notes:</strong> {{NOTES}}</p>
                <p style="margin:10px 0 0;font-size:14px;color:#b0b0b0;">Booking ID: {{BOOKING_ID}}</p>
              </div>

              <p style="font-size:15px;color:#b0b0b0;margin-bottom:20px;text-align:center;">
                Add this meeting to your calendar:
              </p>

              <table align="center" cellpadding="0" cellspacing="0" border="0" style="margin:auto;">
                <tr>
                  <td align="center" style="padding-right:10px;">
                    <a href="https://calendar.google.com/calendar/render?action=TEMPLATE&text={{MEETING_TITLE}}&dates={{MEETING_DATE}}T{{START_TIME}}00Z/{{MEETING_DATE}}T{{END_TIME}}00Z&details={{NOTES}}&location={{MEETING_ROOM}}&sf=true&output=xml"
                       target="_blank"
                       style="display:inline-flex;align-items:center;gap:8px;padding:12px 20px;font-weight:600;font-size:14px;color:#ffffff;text-decoration:none;background:linear-gradient(135deg,#00bcd4,#2c5364);border-radius:8px;box-shadow:0 4px 15px rgba(0,188,212,0.3);">
                      <img src="https://cdn-icons-png.flaticon.com/512/281/281769.png" alt="Google Calendar" width="18" height="18">
                      Add to Google
                    </a>
                  </td>
                </tr>
              </table>

              <p style="font-size:13px;color:#888;margin-top:25px;text-align:center;">
                Please mark your calendar accordingly.
              </p>
            </td>
          </tr>

          <!-- Footer -->
          <tr>
            <td align="center" style="background:#203a43;padding:15px;border-top:1px solid rgba(245,245,245,0.08);font-size:12px;color:#b0b0b0;">
              ¬© 2025 Your Company. All rights reserved.
            </td>
          </tr>

        </table>
      </td>
    </tr>
  </table>

</body>
</html>
`;
}
